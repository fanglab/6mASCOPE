
from pbcore.io import openDataSet

from pysiv2.custom.base import TestBase


class TestAutoCCSUUID(TestBase):

    def test_use_consensus_read_set_uuid_from_run_design(self):
        print self.entrypoints.data['eid_subread']
        ds_in = openDataSet(self.entrypoints.data['eid_subread'])
        uuid = ds_in.metadata.collections[0].consensusReadSetRef.uuid
        assert uuid is not None
        for file_id, f in self.datastore.get_file_dict().iteritems():
            if f.file_id.startswith("pbcoretools.tasks.update_consensus_reads"):
                ds_ccs = openDataSet(f.path)
                self.assertEqual(ds_ccs.uuid, uuid)
